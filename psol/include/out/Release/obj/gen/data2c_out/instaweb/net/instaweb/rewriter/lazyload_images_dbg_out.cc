// Copyright 2011 Google Inc. All Rights Reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// Automatically generated from /usr/src/modpagespeed/out/Release/obj/gen/closure_out/instaweb/rewriter/lazyload_images_dbg.js

namespace net_instaweb {

const char* JS_lazyload_images =
    "(function(){var pagespeedutils = {MAX_POST_SIZE:131072, send"
    "Beacon:function(a, b, c) {\n  var d;\n  if (window.XMLHttpRequ"
    "est) {\n    d = new XMLHttpRequest;\n  } else {\n    if (window"
    ".ActiveXObject) {\n      try {\n        d = new ActiveXObject("
    "\"Msxml2.XMLHTTP\");\n      } catch (f) {\n        try {\n       "
    "   d = new ActiveXObject(\"Microsoft.XMLHTTP\");\n        } cat"
    "ch (g) {\n        }\n      }\n    }\n  }\n  if (!d) {\n    return "
    "!1;\n  }\n  var e = -1 == a.indexOf(\"?\") ? \"?\" : \"&\";\n  a = a "
    "+ e + \"url=\" + encodeURIComponent(b);\n  d.open(\"POST\", a);\n "
    " d.setRequestHeader(\"Content-Type\", \"application/x-www-form-"
    "urlencoded\");\n  d.send(c);\n  return !0;\n}, addHandler:functi"
    "on(a, b, c) {\n  if (a.addEventListener) {\n    a.addEventList"
    "ener(b, c, !1);\n  } else {\n    if (a.attachEvent) {\n      a."
    "attachEvent(\"on\" + b, c);\n    } else {\n      var d = a[\"on\" "
    "+ b];\n      a[\"on\" + b] = function() {\n        c.call(this);"
    "\n        d && d.call(this);\n      };\n    }\n  }\n}, getPositio"
    "n:function(a) {\n  for (var b = a.offsetTop, c = a.offsetLeft"
    ";a.offsetParent;) {\n    a = a.offsetParent, b += a.offsetTop"
    ", c += a.offsetLeft;\n  }\n  return {top:b, left:c};\n}, getWin"
    "dowSize:function() {\n  return {height:window.innerHeight || "
    "document.documentElement.clientHeight || document.body.clien"
    "tHeight, width:window.innerWidth || document.documentElement"
    ".clientWidth || document.body.clientWidth};\n}, inViewport:fu"
    "nction(a, b) {\n  var c = pagespeedutils.getPosition(a);\n  re"
    "turn pagespeedutils.positionInViewport(c, b);\n}, positionInV"
    "iewport:function(a, b) {\n  return a.top < b.height && a.left"
    " < b.width;\n}, getRequestAnimationFrame:function() {\n  retur"
    "n window.requestAnimationFrame || window.webkitRequestAnimat"
    "ionFrame || window.mozRequestAnimationFrame || window.oReque"
    "stAnimationFrame || window.msRequestAnimationFrame || null;\n"
    "}};\npagespeedutils.now = Date.now || function() {\n  return +"
    "new Date;\n};\nwindow.pagespeed = window.pagespeed || {};\nvar "
    "pagespeed = window.pagespeed;\npagespeed.LazyloadImages = fun"
    "ction(a) {\n  this.deferred_ = [];\n  this.buffer_ = 0;\n  this"
    ".force_load_ = !1;\n  this.blank_image_src_ = a;\n  this.scrol"
    "l_timer_ = null;\n  this.last_scroll_time_ = 0;\n  this.min_sc"
    "roll_time_ = 200;\n  this.onload_done_ = !1;\n  this.imgs_to_l"
    "oad_before_beaconing_ = 0;\n};\npagespeed.LazyloadImages.proto"
    "type.countDeferredImgs_ = function() {\n  for (var a = 0, b ="
    " document.getElementsByTagName(\"img\"), c = 0, d;d = b[c];c++"
    ") {\n    -1 != d.src.indexOf(this.blank_image_src_) && this.h"
    "asAttribute_(d, \"data-pagespeed-lazy-src\") && a++;\n  }\n  ret"
    "urn a;\n};\npagespeed.LazyloadImages.prototype.viewport_ = fun"
    "ction() {\n  var a = 0;\n  \"number\" == typeof window.pageYOffs"
    "et ? a = window.pageYOffset : document.body && document.body"
    ".scrollTop ? a = document.body.scrollTop : document.document"
    "Element && document.documentElement.scrollTop && (a = docume"
    "nt.documentElement.scrollTop);\n  var b = window.innerHeight "
    "|| document.documentElement.clientHeight || document.body.cl"
    "ientHeight;\n  return {top:a, bottom:a + b, height:b};\n};\npag"
    "espeed.LazyloadImages.prototype.compute_top_ = function(a) {"
    "\n  var b = a.getAttribute(\"data-pagespeed-lazy-position\");\n "
    " if (b) {\n    return parseInt(b, 0);\n  }\n  var b = a.offsetT"
    "op, c = a.offsetParent;\n  c && (b += this.compute_top_(c));\n"
    "  b = Math.max(b, 0);\n  a.setAttribute(\"data-pagespeed-lazy-"
    "position\", b);\n  return b;\n};\npagespeed.LazyloadImages.proto"
    "type.offset_ = function(a) {\n  var b = this.compute_top_(a);"
    "\n  return {top:b, bottom:b + a.offsetHeight};\n};\npagespeed.L"
    "azyloadImages.prototype.getStyle_ = function(a, b) {\n  if (a"
    ".currentStyle) {\n    return a.currentStyle[b];\n  }\n  if (doc"
    "ument.defaultView && document.defaultView.getComputedStyle) "
    "{\n    var c = document.defaultView.getComputedStyle(a, null)"
    ";\n    if (c) {\n      return c.getPropertyValue(b);\n    }\n  }"
    "\n  return a.style && a.style[b] ? a.style[b] : \"\";\n};\npagesp"
    "eed.LazyloadImages.prototype.isVisible_ = function(a) {\n  if"
    " (!this.onload_done_ && (0 == a.offsetHeight || 0 == a.offse"
    "tWidth)) {\n    return !1;\n  }\n  if (\"relative\" == this.getSt"
    "yle_(a, \"position\")) {\n    return !0;\n  }\n  var b = this.vie"
    "wport_(), c = a.getBoundingClientRect();\n  c ? (a = c.top - "
    "b.height, b = c.bottom) : (c = this.offset_(a), a = c.top - "
    "b.bottom, b = c.bottom - b.top);\n  return a <= this.buffer_ "
    "&& 0 <= b + this.buffer_;\n};\npagespeed.LazyloadImages.protot"
    "ype.loadIfVisibleAndMaybeBeacon = function(a) {\n  this.overr"
    "ideAttributeFunctionsInternal_(a);\n  var b = this;\n  window."
    "setTimeout(function() {\n    var c = a.getAttribute(\"data-pag"
    "espeed-lazy-src\");\n    if (c) {\n      if ((b.force_load_ || "
    "b.isVisible_(a)) && -1 != a.src.indexOf(b.blank_image_src_))"
    " {\n        var d = a.parentNode, e = a.nextSibling;\n        "
    "d && d.removeChild(a);\n        a._getAttribute && (a.getAttr"
    "ibute = a._getAttribute);\n        a.removeAttribute(\"onload\""
    ");\n        a.tagName && \"IMG\" == a.tagName && pagespeed.Crit"
    "icalImages && pagespeedutils.addHandler(a, \"load\", function("
    "a) {\n          pagespeed.CriticalImages.checkImageForCritica"
    "lity(this);\n          b.onload_done_ && (b.imgs_to_load_befo"
    "re_beaconing_--, 0 == b.imgs_to_load_before_beaconing_ && pa"
    "gespeed.CriticalImages.checkCriticalImages());\n        });\n "
    "       a.removeAttribute(\"data-pagespeed-lazy-src\");\n       "
    " a.removeAttribute(\"data-pagespeed-lazy-replaced-functions\")"
    ";\n        d && d.insertBefore(a, e);\n        if (d = a.getAt"
    "tribute(\"data-pagespeed-lazy-srcset\")) {\n          a.srcset "
    "= d, a.removeAttribute(\"data-pagespeed-lazy-srcset\");\n      "
    "  }\n        a.src = c;\n      } else {\n        b.deferred_.pu"
    "sh(a);\n      }\n    }\n  }, 0);\n};\npagespeed.LazyloadImages.pr"
    "ototype.loadIfVisibleAndMaybeBeacon = pagespeed.LazyloadImag"
    "es.prototype.loadIfVisibleAndMaybeBeacon;\npagespeed.Lazyload"
    "Images.prototype.loadAllImages = function() {\n  this.force_l"
    "oad_ = !0;\n  this.loadVisible_();\n};\npagespeed.LazyloadImage"
    "s.prototype.loadAllImages = pagespeed.LazyloadImages.prototy"
    "pe.loadAllImages;\npagespeed.LazyloadImages.prototype.loadVis"
    "ible_ = function() {\n  var a = this.deferred_, b = a.length;"
    "\n  this.deferred_ = [];\n  for (var c = 0;c < b;++c) {\n    th"
    "is.loadIfVisibleAndMaybeBeacon(a[c]);\n  }\n};\npagespeed.Lazyl"
    "oadImages.prototype.hasAttribute_ = function(a, b) {\n  retur"
    "n a.getAttribute_ ? null != a.getAttribute_(b) : null != a.g"
    "etAttribute(b);\n};\npagespeed.LazyloadImages.prototype.overri"
    "deAttributeFunctions = function() {\n  for (var a = document."
    "getElementsByTagName(\"img\"), b = 0, c;c = a[b];b++) {\n    th"
    "is.hasAttribute_(c, \"data-pagespeed-lazy-src\") && this.overr"
    "ideAttributeFunctionsInternal_(c);\n  }\n};\npagespeed.Lazyload"
    "Images.prototype.overrideAttributeFunctions = pagespeed.Lazy"
    "loadImages.prototype.overrideAttributeFunctions;\npagespeed.L"
    "azyloadImages.prototype.overrideAttributeFunctionsInternal_ "
    "= function(a) {\n  var b = this;\n  this.hasAttribute_(a, \"dat"
    "a-pagespeed-lazy-replaced-functions\") || (a._getAttribute = "
    "a.getAttribute, a.getAttribute = function(a) {\n    \"src\" == "
    "a.toLowerCase() && b.hasAttribute_(this, \"data-pagespeed-laz"
    "y-src\") && (a = \"data-pagespeed-lazy-src\");\n    return this."
    "_getAttribute(a);\n  }, a.setAttribute(\"data-pagespeed-lazy-r"
    "eplaced-functions\", \"1\"));\n};\npagespeed.lazyLoadInit = funct"
    "ion(a, b) {\n  var c = new pagespeed.LazyloadImages(b);\n  pag"
    "espeed.lazyLoadImages = c;\n  pagespeedutils.addHandler(windo"
    "w, \"load\", function() {\n    c.onload_done_ = !0;\n    c.force"
    "_load_ = a;\n    c.buffer_ = 200;\n    pagespeed.CriticalImage"
    "s && (c.imgs_to_load_before_beaconing_ = c.countDeferredImgs"
    "_(), 0 == c.imgs_to_load_before_beaconing_ && pagespeed.Crit"
    "icalImages.checkCriticalImages());\n    c.loadVisible_();\n  }"
    ");\n  0 != b.indexOf(\"data\") && ((new Image).src = b);\n  var "
    "d = function() {\n    if (!(c.onload_done_ && a || c.scroll_t"
    "imer_)) {\n      var b = (new Date).getTime(), d = c.min_scro"
    "ll_time_;\n      b - c.last_scroll_time_ > c.min_scroll_time_"
    " && (d = 0);\n      c.scroll_timer_ = window.setTimeout(funct"
    "ion() {\n        c.last_scroll_time_ = (new Date).getTime();\n"
    "        c.loadVisible_();\n        c.scroll_timer_ = null;\n  "
    "    }, d);\n    }\n  };\n  pagespeedutils.addHandler(window, \"s"
    "croll\", d);\n  pagespeedutils.addHandler(window, \"resize\", d)"
    ";\n};\npagespeed.lazyLoadInit = pagespeed.lazyLoadInit;\n})();\n";

}  // namespace net_instaweb
